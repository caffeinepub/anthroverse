{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix member approval authorization bug",
  "requirements": [
    {
      "id": "REQ-2",
      "summary": "Fix the frontend AdminPage pending-users approval flow so that the authenticated caller's identity is correctly passed to the backend actor and the UI reflects the updated approval state after success",
      "acceptanceCriteria": [
        "Clicking the approve button on a pending user in AdminPage triggers the backend call with the correct authenticated identity",
        "On success, the pending user is removed from the pending list and appears in the approved members list",
        "On failure, a clear error toast or message is shown to the admin"
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Review and fix the useApproveOrRejectUser mutation to ensure it correctly uses the authenticated actor when calling approveOrRejectUser. Verify that the mutation invalidates the correct query keys (pendingApprovals, allUsers) on success and displays error toasts on failure. The authenticated actor from useActor() must be used to make the backend call with the caller's principal."
        },
        {
          "path": "frontend/src/pages/AdminPage.tsx",
          "operation": "modify",
          "description": "Review the pending users approval UI and ensure that clicking the approve/reject buttons correctly triggers the useApproveOrRejectUser mutation with the proper user principal and approval status. Add success/error toast feedback and verify that the UI refreshes the pending users list after a successful approval. Ensure the component waits for the authenticated actor to be available before allowing approval actions."
        }
      ]
    }
  ]
}